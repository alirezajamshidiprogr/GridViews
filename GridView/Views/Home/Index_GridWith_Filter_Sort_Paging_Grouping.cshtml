@using GeneralModal.Models;
@using GeneralModal.TagHelper;
@using GridView.Enums;
@using GridView.ViewModel;
@using GridView.TagHelpers
@using static GridView.TagHelpers.DynamicGridExtensions

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"> <!-- ابتدا Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" /> <!-- سپس Select2 -->
<link href="~/css/Eorc_GridView.css" rel="stylesheet" /> <!-- استایل‌های سفارشی شما -->
@{
    var gridUrl1 = Url.Action("GetGridViewData1", "Home");
}

@*<div class="row">
    <div style="width: 300px; margin: 50px auto;">
        <label for="mySelect">چند گزینه را انتخاب کنید:</label>
        <select id="mySelect" multiple="multiple" style="width: 100%">
            <option value="1">گزینه اول</option>
            <option value="2">گزینه دوم</option>
            <option value="3">گزینه سوم</option>
            <option value="4">گزینه چهارم</option>
            <option value="5">گزینه پنجم</option>
        </select>

    </div>
</div>*@

@{
    var modal = new GenericModalBuilder("myModal")
        .Title("مدال نمونه")
        .HeaderHtml("<h5 class='modal-title'>عنوان دلخواه هدر</h5>")
        .Size(ModalSize.Large)
        .Columns(2)
        .EnableValidation(true)
        .BodyHtml(
            new TextBox { Id = "txtName", LabelText = "نام ", Class = "form-control", Placeholder = "نام خود را وارد کنید", Required = true, MinLength = 3, MaxLength = 50, ValidationMessage = "نام باید بین 3 تا 50 کاراکتر باشد." },
            new TextBox { Id = "txtFamily", LabelText = "فاميلي ", Class = "form-control", Placeholder = "فاميلي خود را وارد کنید", Required = true, MinLength = 3, MaxLength = 50, ValidationMessage = "نام باید بین 3 تا 50 کاراکتر باشد." },
            new TextBox { Id = "txtEmail", LabelText = "ايميل ",  Class = "form-control", Placeholder = "ایمیل خود را وارد کنید", Required = true, Pattern = @"^[^@\s]+@[^@\s]+\.[^@\s]+$", ValidationMessage = "ایمیل نامعتبر است." },
            new PasswordBox { Id = "txtPassword", LabelText = "رمز عبور", Class = "form-control", Placeholder = "رمز عبور", Required = true, MinLength = 6, ValidationMessage = "رمز عبور حداقل 6 کاراکتر باشد." },
            new CheckBox { Id = "chkAgree", Value = "غير فعال", LabelText = "وضعيت", Class = "form-check-input", Required = true, ValidationMessage = "باید تیک توافق را بزنید." },
            new Select { Id = "status", Name = "status", LabelText = "وضعیت", Required = true, Items = new List<ListItem> { new ListItem("1", "فعال"), new ListItem("0", "غیرفعال") }, SelectedValues = new List<string> { "1" } },
            new MultiSelect { Id = "multiSelectRoles", Name = "roles", LabelText = "نقش‌ها", Required = true, Items = new List<ListItem> { new ListItem("admin", "مدیر"), new ListItem("editor", "ویراستار"), new ListItem("user", "کاربر عادی") }, SelectedValues = new List<string> { "user", "editor" }, UseSelect2 = true },
            new MultiSelectSelect2
                    {
                        Id = "multiSelectRolesSelect2",
                        Name = "rolesSelect2",
                        LabelText = "نقش‌ها (Select2)",
                        Required = true,
                        Items = new List<ListItem> {
                    new ListItem("admin", "مدیر"),
                    new ListItem("editor", "ویراستار"),
                    new ListItem("user", "کاربر عادی")
                                        },
                        //SelectedValues = new List<string> { "user", "editor" }
                    },
            new TextArea { Id = "txtMessage", LabelText = "شرح", Class = "form-control", Placeholder = "پیام خود را وارد کنید", Rows = 4 },
            new Button {Id="btnload" , OnClick="alert()", Name = "دكمه من" ,Text = "myButton"}
         )
        .FooterHtml(@"<button class='btn btn-primary' onclick='submitModalForm()'>ثبت</button>
                     <button class='btn btn-primary' onclick='closeModal_myModal()'>بستن</button>")
        .Build();
}

@modal

@{
    var model = new List<ProductSaleModel>();
}
@(
     Eorc_Grid<ProductSaleModel>("grdProduct1")
        .Url(gridUrl1)
        .Items(model.Cast<object>().ToList())
        .EditJavaScriptFunction("OpenModalSearch()")
        .DeleteJavaScriptFunction("CloseModalSearch()")
        .PageSize(10)
        .EnablePaging(true)
        .EnableFiltering(true)
        .EnableSorting(true)
        .EnableFooter(true)
        .EnableGrouping(true)
        .EnableExcelExport(true)
        .EnablePDFExport(true)
        .EnablePrint(true)
        .EnableEditButton(true)
        .EnableDeleteButton(true)
        .EnableLazyLoading(false)
        .EnableAdvancedFilter(true)
        .EnableInlineEdit(true)
        .EnableShowHiddenColumns(true)
        .AddCustomHtml("<button class='grid-print-btn' onclick='openFilterPopup()'>style</button>")
        .Build()
)

<!-- بارگذاری JS -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script src="~/js/html2canvas.min.js"></script>
<script src="~/js/pdfmake.min.js"></script>
<script src="~/js/vfs_fonts.js"></script>
<script src="~/js/modal.js"></script>
<script src="~/js/xlsx.full.min.js"></script>
<script src="~/js/Eorc_GridView.js"></script>
<script src="~/js/userjs.js"></script>


<script>

   $(document).ready(function () {
        //$('#mySelect').select2({
        //    placeholder: "گزینه‌ها را انتخاب کنید...",
        //    width: '100%',
        //    tags: true,
        //    tokenSeparators: [',', ' ']
        //});

        //$('#mySelect').select2({
        //    placeholder: "انتخاب کنید...",
        //    allowClear: true
        //});
    });

    function OpenModalSearch() {
        openModal_myModal('myModal');
    }

    function CloseModalSearch() {
        closeModal_myModal('myModal');
    }

    function submitModalForm() {
        var isValid = IsValidForm_myModal('myModal');

        if (!isValid) {
            alert('لطفاً تمام فیلدهای اجباری را کامل کنید!');
            return;
        }

        alert('فرم معتبر است، می‌توانید ادامه دهید!');
    }

    document.addEventListener('DOMContentLoaded', function () {
        let currentPage = 1;
        let pageSize = parseInt(document.getElementById('pageSizeSelector')?.value) || 30;

        customRequestBody = {
            searchTerm: "تبلت",
            name: "test",
        };

        fetchGridData(currentPage, pageSize, customRequestBody);
        enableRowDetailsPopup('grdProduct1');
    });
</script>
